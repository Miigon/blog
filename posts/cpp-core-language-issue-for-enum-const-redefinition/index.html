<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="è®°ä¸€æ¬¡ C++ æ ¸å¿ƒè¯­è¨€æ ‡å‡†ä¸­ä¸€ä¸ª issue çš„å‘ç°å’Œæäº¤ç»å†" /><meta property="og:locale" content="en" /><meta name="description" content="è¯¥æ–‡ç« è®°å½•è‡ªå·±çš„ä¸€æ¬¡å‘ç°ä¸€ä¸ª C++ æ ¸å¿ƒè¯­è¨€æ ‡å‡†è§„å®šä¸­ï¼Œå…³äºæšä¸¾é‡é‡å®šä¹‰çš„ä¸€ä¸ªè§„åˆ™ç¼ºé™·ï¼ˆdefectï¼‰å¹¶æäº¤çš„ç»å†ã€‚æ‰€æœ‰å¯¹æ ‡å‡†çš„å¼•ç”¨ä»¥ N4901 è‰æ¡ˆä¸ºå‡†ï¼ˆå½“æ—¶çš„è¾ƒæ–°ç‰ˆæœ¬ï¼‰ã€‚" /><meta property="og:description" content="è¯¥æ–‡ç« è®°å½•è‡ªå·±çš„ä¸€æ¬¡å‘ç°ä¸€ä¸ª C++ æ ¸å¿ƒè¯­è¨€æ ‡å‡†è§„å®šä¸­ï¼Œå…³äºæšä¸¾é‡é‡å®šä¹‰çš„ä¸€ä¸ªè§„åˆ™ç¼ºé™·ï¼ˆdefectï¼‰å¹¶æäº¤çš„ç»å†ã€‚æ‰€æœ‰å¯¹æ ‡å‡†çš„å¼•ç”¨ä»¥ N4901 è‰æ¡ˆä¸ºå‡†ï¼ˆå½“æ—¶çš„è¾ƒæ–°ç‰ˆæœ¬ï¼‰ã€‚" /><link rel="canonical" href="https://blog.miigon.net/posts/cpp-core-language-issue-for-enum-const-redefinition/" /><meta property="og:url" content="https://blog.miigon.net/posts/cpp-core-language-issue-for-enum-const-redefinition/" /><meta property="og:site_name" content="Miigonâ€™s blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-04-02T22:10:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="è®°ä¸€æ¬¡ C++ æ ¸å¿ƒè¯­è¨€æ ‡å‡†ä¸­ä¸€ä¸ª issue çš„å‘ç°å’Œæäº¤ç»å†" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-07-25T17:57:21+08:00","datePublished":"2022-04-02T22:10:00+08:00","description":"è¯¥æ–‡ç« è®°å½•è‡ªå·±çš„ä¸€æ¬¡å‘ç°ä¸€ä¸ª C++ æ ¸å¿ƒè¯­è¨€æ ‡å‡†è§„å®šä¸­ï¼Œå…³äºæšä¸¾é‡é‡å®šä¹‰çš„ä¸€ä¸ªè§„åˆ™ç¼ºé™·ï¼ˆdefectï¼‰å¹¶æäº¤çš„ç»å†ã€‚æ‰€æœ‰å¯¹æ ‡å‡†çš„å¼•ç”¨ä»¥ N4901 è‰æ¡ˆä¸ºå‡†ï¼ˆå½“æ—¶çš„è¾ƒæ–°ç‰ˆæœ¬ï¼‰ã€‚","headline":"è®°ä¸€æ¬¡ C++ æ ¸å¿ƒè¯­è¨€æ ‡å‡†ä¸­ä¸€ä¸ª issue çš„å‘ç°å’Œæäº¤ç»å†","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.miigon.net/posts/cpp-core-language-issue-for-enum-const-redefinition/"},"url":"https://blog.miigon.net/posts/cpp-core-language-issue-for-enum-const-redefinition/"}</script><title>è®°ä¸€æ¬¡ C++ æ ¸å¿ƒè¯­è¨€æ ‡å‡†ä¸­ä¸€ä¸ª issue çš„å‘ç°å’Œæäº¤ç»å† | Miigon's blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Miigon's blog"><meta name="application-name" content="Miigon's blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/avatar.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Miigon's blog</a></div><div class="site-subtitle font-italic">My ideas, thoughts and experiences</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/Miigon" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['miigon.pg','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://stackoverflow.com/users/7509248/miigon" aria-label="stack-overflow" target="_blank" rel="noopener"> <i class="fab fa-stack-overflow"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>è®°ä¸€æ¬¡ C++ æ ¸å¿ƒè¯­è¨€æ ‡å‡†ä¸­ä¸€ä¸ª issue çš„å‘ç°å’Œæäº¤ç»å†</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>è®°ä¸€æ¬¡ C++ æ ¸å¿ƒè¯­è¨€æ ‡å‡†ä¸­ä¸€ä¸ª issue çš„å‘ç°å’Œæäº¤ç»å†</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1648908600" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Apr 2, 2022 </em> </span> <span> Updated <em class="" data-ts="1658743041" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jul 25, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/Miigon">Miigon</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2344 words"> <em>13 min</em> read</span></div></div></div><div class="post-content"><blockquote><p>è¯¥æ–‡ç« è®°å½•è‡ªå·±çš„ä¸€æ¬¡å‘ç°ä¸€ä¸ª C++ æ ¸å¿ƒè¯­è¨€æ ‡å‡†è§„å®šä¸­ï¼Œå…³äºæšä¸¾é‡é‡å®šä¹‰çš„ä¸€ä¸ªè§„åˆ™ç¼ºé™·ï¼ˆdefectï¼‰å¹¶æäº¤çš„ç»å†ã€‚æ‰€æœ‰å¯¹æ ‡å‡†çš„å¼•ç”¨ä»¥ N4901 è‰æ¡ˆä¸ºå‡†ï¼ˆå½“æ—¶çš„è¾ƒæ–°ç‰ˆæœ¬ï¼‰ã€‚</p></blockquote><p><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/n4901.pdf">C++ æ ¸å¿ƒè¯­è¨€æ ‡å‡† N4901 è‰æ¡ˆ</a></p><h1 id="å¼•è¨€">å¼•è¨€</h1><p>é—®é¢˜æœ¬èº«æ˜¯å…³äº enum ä¸­æšä¸¾å€¼ (enumerator) çš„é‡å¤å®šä¹‰é—®é¢˜çš„ã€‚</p><p>ä¾‹å­å¦‚ä¸‹ï¼š</p><div class="language-c++ highlighter-rouge"><div class="code-header"> <span data-label-text="C++"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="k">enum</span> <span class="p">{</span>
	<span class="n">ee</span><span class="p">,</span> <span class="n">ee</span>
<span class="p">};</span>
</pre></table></code></div></div><p>ä¸Šé¢çš„ä»£ç ï¼Œæ— è®ºæ˜¯åœ¨ gcc/clang è¿˜æ˜¯ g++/clang++ ä¸Šï¼Œç¼–è¯‘éƒ½æ˜¯ä¸èƒ½é€šè¿‡çš„ï¼ŒæŠ¥é”™å¦‚ä¸‹ï¼š</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>enumtest.cpp:3:2: error: redefinition of enumerator 'A'
        A,
        ^
enumtest.cpp:2:2: note: previous definition is here
        A,
        ^
1 error generated.
</pre></table></code></div></div><p>ä¹Ÿå°±æ˜¯å¸¸ç”¨çš„ä¸¤ä¸ªç¼–è¯‘å™¨å®ç°ä¸Šï¼Œæ— è®º C è¿˜æ˜¯ C++ éƒ½ä¸å…è®¸æšä¸¾å€¼çš„é‡å¤å®šä¹‰ï¼ˆæ³¨æ„åŒºåˆ†æšä¸¾ç±»å‹å’Œæšä¸¾å€¼ï¼‰ã€‚</p><p>C99 è‰æ¡ˆä¸­å¯¹è¯¥è¡Œä¸ºä½œå‡ºäº†æ˜ç¡®è§„å®šï¼š</p><blockquote><p>From the draft of C99, Section 6.7:<br /> 6.7.5. A declaration specifies the interpretation and attributes of a set of identifiers. A definition of an identifier is a declaration for that identifier that:<br /> â€” for an object, causes storage to be reserved for that object;<br /> â€” for a function, includes the function body; <br /> â€” for an <strong>enumeration constant or typedef name, is the (only) declaration of the identifier.</strong></p></blockquote><p>enumeration constant å³æšä¸¾å¸¸é‡ï¼Œä¹Ÿå°±æ˜¯ä¸Šè¿°ä»£ç ä¸­çš„ <code class="language-plaintext highlighter-rouge">ee</code>ã€‚C è¯­è¨€æ ‡å‡†çš„è¿™ä¸€è§„å®šï¼Œå°±é¿å…äº†åŒä¸€ä¸ªæ ‡è¯†ç¬¦è¢«å¤šæ¬¡ç”¨äºå®šä¹‰æšä¸¾å€¼ã€‚åœ¨å®é™…çš„ä½¿ç”¨ä¸­è¿™ä¸€è¡Œä¸ºä¹Ÿç¬¦åˆé€»è¾‘ï¼Œå› ä¸ºæ¯ä¸€ä¸ªæšä¸¾å€¼åœ¨æœªæŒ‡å®šå…·ä½“å¸¸æ•°å€¼çš„æƒ…å†µä¸‹ï¼Œæ˜¯é€’å¢åˆ†é…æ•´å½¢å¸¸æ•°å€¼çš„ï¼Œå¦‚æœå…è®¸æšä¸¾å€¼ enumerator åŒåå¯èƒ½å¯¼è‡´ä¸€ä¸ªæšä¸¾å€¼åå­—å¯¹åº”å¤šä¸ªå¸¸æ•°å€¼ï¼Œé€ æˆæ­§ä¹‰ã€‚</p><h1 id="é—®é¢˜">é—®é¢˜</h1><p>æŒ‰ç†æ¥è¯´ï¼ŒC++ åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹éƒ½å¯ä»¥è®¤ä¸ºæ˜¯ C çš„è¶…é›†ï¼ŒC æ ‡å‡†æ˜ç¡®è§„å®šä¸èƒ½é€šè¿‡ç¼–è¯‘çš„ä»£ç ï¼Œåœ¨ C++ ä¸­åº”è¯¥ä¹Ÿä¸èƒ½é€šè¿‡ã€‚ç”±äºæšä¸¾ç±»å‹å®šä¹‰çš„æ—¶å€™ï¼Œä¼šé¡ºå¸¦å®šä¹‰å…¶ä¸­çš„æ‰€æœ‰æšä¸¾å€¼ï¼Œåˆå› ä¸ºå®šä¹‰æ˜¯ä¸€ç§ç‰¹æ®Šçš„å£°æ˜ï¼Œé‚£ä¹ˆ C++ æ ‡å‡†ä¸­å°±å¿…ç„¶å­˜åœ¨ä¸€å®šçš„è§„åˆ™ï¼Œè¦ä¹ˆé˜»æ­¢æšä¸¾é‡çš„é‡å¤å®šä¹‰ï¼Œè¦ä¹ˆé˜»æ­¢æšä¸¾é‡çš„é‡å¤å£°æ˜ï¼Œä½¿å¾—ä¸Šè¿°ä»£ç éæ³•ã€‚</p><h2 id="one-definition-rule-ä¸é˜»æ­¢æšä¸¾é‡çš„é‡å¤å®šä¹‰"><span class="mr-2">One-definition rule ä¸é˜»æ­¢æšä¸¾é‡çš„é‡å¤å®šä¹‰</span><a href="#one-definition-rule-ä¸é˜»æ­¢æšä¸¾é‡çš„é‡å¤å®šä¹‰" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>å‡ºäºå¥½å¥‡ï¼ŒæŸ¥æ‰¾äº†ä¸€ä¸‹ C++ å…³äºè¿™æ–¹é¢çš„è§„å®šï¼Œäº†è§£åˆ° C++ ä¸­ï¼Œæœ‰ä¸€ä¸ªå•ç‹¬åˆ—å‡ºçš„ One-definition rule æ¡ç›®ï¼ˆ6.3 [basic.def.odr]ï¼‰ï¼Œå…¶ä¸­ç¬¬ä¸€æ¡è§„å®šå¦‚ä¸‹ï¼š</p><blockquote><p>No translation unit shall contain more than one definition of any variable, function, class type, enumeration type, template, default argument for a parameter (for a function in a given scope), or default template argument.</p></blockquote><p>å³ï¼šæ‰€æœ‰çš„ç¿»è¯‘å•å…ƒéƒ½ä¸å¯ä»¥åŒ…å«å¤šäºä¸€ä¸ªçš„ä»»ä½•å˜é‡ã€å‡½æ•°ã€ç±»ã€<strong>æšä¸¾ç±»å‹</strong>ã€æ¨¡ç‰ˆã€å‚æ•°é»˜è®¤å€¼æˆ–é»˜è®¤æ¨¡ç‰ˆå‚æ•°çš„å®šä¹‰ã€‚</p><p>è¿™é‡Œç‰¹åˆ«æ³¨æ„åˆ°ï¼Œ<strong>One-definition rule é™åˆ¶äº†ã€Œæšä¸¾ç±»å‹ã€çš„é‡å¤å®šä¹‰ï¼Œä½†æ˜¯æ²¡æœ‰é™åˆ¶ã€Œæšä¸¾é‡ã€çš„é‡å¤å®šä¹‰ã€‚</strong></p><p>å½“ç„¶ One-definition rule ç›¸å½“äºæ˜¯åœ¨åŸæ¥çš„å£°æ˜/å®šä¹‰è§„åˆ™ä¸Šæ‰“çš„ä¸€ä¸ªâ€œè¡¥ä¸â€ï¼Œç›´æ¥ç”¨ç‰¹æ®Šè§„åˆ™æ¥é™åˆ¶ä¸€äº›ç§ç±»å®ä½“çš„é‡å¤å®šä¹‰ã€‚å¹¶ä¸ä»£è¡¨æ ‡å‡†ä¸­çš„å…¶ä»–è§„åˆ™å°±ä¸ä¼šé™åˆ¶é‡å¤å®šä¹‰çš„æšä¸¾å€¼çš„å­˜åœ¨ï¼ˆè¿™åœ¨åç»­ä¸å§”å‘˜ä¼šçš„é‚®ä»¶äº¤æµä¸­ä¹Ÿæ¶‰åŠåˆ°äº†ï¼‰ï¼Œæ‰€ä»¥è¿™é‡Œæ²¡æœ‰é™åˆ¶å¹¶ä¸è¶³ä»¥ä½œä¸ºå…è®¸æšä¸¾é‡é‡å¤å®šä¹‰çš„å……åˆ†æ¡ä»¶ã€‚</p><p>ç”±äºå®šä¹‰æ˜¯ä¸€ç§ç‰¹æ®Šçš„å£°æ˜ï¼Œè™½ç„¶å®šä¹‰ definition ç›¸å…³çš„è§„åˆ™æ²¡èƒ½é˜»æ­¢ä¾‹å­ä¸­çš„ä»£ç é€šè¿‡ç¼–è¯‘ï¼Œä½†æ˜¯ä»ç„¶æœ‰å¯èƒ½åœ¨å£°æ˜ declaration ä¸­é˜»æ­¢äº†è¿™æ ·é‡å¤å£°æ˜æšä¸¾é‡çš„æƒ…å†µå‡ºç°ï¼Œæ•…ç»§ç»­æ¢å¯»ï¼Œå‘ç°ï¼š</p><h2 id="declaration-å£°æ˜è§„åˆ™å…è®¸æšä¸¾é‡é‡å¤å£°æ˜"><span class="mr-2">declaration å£°æ˜è§„åˆ™å…è®¸æšä¸¾é‡é‡å¤å£°æ˜</span><a href="#declaration-å£°æ˜è§„åˆ™å…è®¸æšä¸¾é‡é‡å¤å£°æ˜" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="ä¸¤æ¬¡-ee-å£°æ˜çš„æ˜¯åŒä¸€å®ä½“"><span class="mr-2">ä¸¤æ¬¡ <code class="language-plaintext highlighter-rouge"><span class="mr-2">ee</code> å£°æ˜çš„æ˜¯åŒä¸€å®ä½“</span><a href="#ä¸¤æ¬¡-ee-å£°æ˜çš„æ˜¯åŒä¸€å®ä½“" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>ç»§ç»­æµè§ˆæ ‡å‡†ä¸­å…³äºå£°æ˜ declaration å’Œå®šä¹‰ definition çš„ç« èŠ‚ï¼Œå¯ä»¥çœ‹åˆ°å¦‚ä¸‹æè¿°ï¼š</p><p>6.6 [basic.link] paragraph 8:</p><blockquote><p><strong>Two declarations</strong> of entities <strong>declare the same entity if</strong>, considering declarations of unnamed types to introduce their names for linkage purposes, if any (9.2.4, 9.7.1), they <strong>correspond</strong> (6.4.1), <strong>have the same target scope</strong> that is not a function or template parameter scope, and either</p><ul><li>they <strong>appear in the same translation unit</strong>, orâ€¦â€¦. ï¼ˆåç»­å‡ ç§æƒ…å†µä¸é—®é¢˜æ— å…³ï¼Œæ•…æ²¡æœ‰åˆ—å‡ºï¼‰</ul></blockquote><p>å³ä¸¤ä¸ªå®ä½“å£°æ˜ï¼ˆåœ¨è¿™é‡ŒæŒ‡ä¸¤æ¬¡æšä¸¾é‡å®šä¹‰ <code class="language-plaintext highlighter-rouge">ee</code> å’Œ <code class="language-plaintext highlighter-rouge">ee</code>ï¼Œå®šä¹‰ä¹Ÿæ˜¯ä¸€ç§å£°æ˜ï¼‰å¦‚æœå®ƒä»¬æ»¡è¶³ï¼š</p><ul><li>ç›¸äº’ã€Œå¯¹åº”ã€ï¼ˆä¾‹å­æ»¡è¶³ï¼‰<li>åœ¨åŒä¸€ä¸ªä½œç”¨åŸŸï¼ˆä¾‹å­æ»¡è¶³ï¼‰<li>ä¸”å‡ºç°åœ¨åŒä¸€ä¸ªç¿»è¯‘å•å…ƒï¼ˆä¾‹å­æ»¡è¶³ï¼‰</ul><p>åˆ™ä»–ä»¬å£°æ˜çš„æ˜¯åŒä¸€ä¸ªå®ä½“ã€‚</p><p>ã€Œå¯¹åº” correspondã€çš„æ„æ€ï¼Œåœ¨6.4.1 [basic.scope.scope], paragraph 4 ä¸­æŒ‡å‡ºï¼š</p><blockquote><p><strong>Two declarations correspond if they (re)introduce the same name</strong>, both declare constructors, or both declare destructors, unlessâ€¦â€¦<br /> ï¼ˆåé¢çš„æ’é™¤æƒ…å†µæ¯”è¾ƒå¤æ‚ï¼Œä½†éƒ½ä¸é€‚ç”¨æœ¬æ–‡ä¸­çš„ä¾‹å­ï¼Œæ•…çœç•¥ï¼‰</p></blockquote><p>åœ¨è¿™é‡Œï¼Œä¸¤ä¸ªæšä¸¾é‡å£°æ˜ç”±äºå¼•å…¥äº†åŒä¸€ä¸ªåå­—ï¼Œæ‰€ä»¥è¯´å®ƒä»¬ã€Œå¯¹åº”ã€ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œä»–ä»¬æ»¡è¶³äº†å£°æ˜åŒä¸€ä¸ªå®ä½“çš„ä¸‰ä¸ªæ¡ä»¶ï¼Œ<strong>ä¸¤æ¬¡ <code class="language-plaintext highlighter-rouge">ee</code> å£°æ˜çš„æ˜¯åŒä¸€å®ä½“</strong>ã€‚</p><blockquote><p>è¿™ä¸ªè§„åˆ™ä¸€èˆ¬æ˜¯æœåŠ¡äºå‡½æ•°å£°æ˜ã€å˜é‡å£°æ˜æˆ–è€…ç±»å‹å£°æ˜çš„ï¼Œå³å¤šæ¬¡å£°æ˜åŒä¸€ä¸ªå‡½æ•°ï¼Œå£°æ˜çš„å…¶å®éƒ½æ˜¯åŒä¸€ä¸ªå‡½æ•°ï¼š</p><div class="language-c++ highlighter-rouge"><div class="code-header"> <span data-label-text="C++"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="c1">// ä¾‹å­ï¼šæ­¤ä»£ç æ˜¯åˆæ³•C++ç¨‹åºï¼Œèƒ½é€šè¿‡ç¼–è¯‘</span>
<span class="kt">void</span> <span class="nf">foobar</span><span class="p">();</span><span class="c1">// å£°æ˜</span>
<span class="kt">void</span> <span class="nf">foobar</span><span class="p">();</span><span class="c1">// å†æ¬¡å£°æ˜</span>
<span class="kt">void</span> <span class="nf">foobar</span><span class="p">()</span> <span class="p">{}</span> <span class="c1">// å†æ¬¡å£°æ˜ï¼Œå¹¶å®šä¹‰ï¼Œå‰é¢æ‰€æœ‰çš„å£°æ˜éƒ½æŒ‡å‘è¿™é‡Œå®šä¹‰çš„å®ä½“</span>
<span class="kt">int</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">foobar</span><span class="p">();</span>
<span class="p">}</span>
</pre></table></code></div></div><p>ä½†æ˜¯åœ¨è¿™ä¸€å¥—è§„åˆ™ä¸‹ï¼Œæˆ‘ä»¬ä¸€å¼€å§‹ä¾‹å­ä¸­çš„æšä¸¾é‡å®šä¹‰ <code class="language-plaintext highlighter-rouge">ee</code> å’Œ <code class="language-plaintext highlighter-rouge">ee</code> ä¹Ÿæ°å¥½ç¬¦åˆè¿™é‡Œçš„è¦æ±‚ï¼Œå³ä¸¤æ¬¡æŒ‡å‘åŒä¸€ä¸ªå®ä½“ã€‚</p></blockquote><p>ä¸¤æ¬¡ <code class="language-plaintext highlighter-rouge">ee</code> å£°æ˜çš„æ˜¯åŒä¸€å®ä½“ä¸ºä»€ä¹ˆé‡è¦å‘¢ï¼Ÿå› ä¸ºå£°æ˜è¿˜æœ‰ä¸€ç§ã€Œå†²çªã€çš„æƒ…å†µå¦‚ä¸‹ï¼š</p><h3 id="ä¸¤æ¬¡-ee-å£°æ˜ä¸æ»¡è¶³å¯èƒ½å†²çªçš„æ¡ä»¶ä¸é€ æˆå†²çª"><span class="mr-2">ä¸¤æ¬¡ <code class="language-plaintext highlighter-rouge"><span class="mr-2">ee</code> å£°æ˜ä¸æ»¡è¶³ã€Œå¯èƒ½å†²çªã€çš„æ¡ä»¶ï¼Œä¸é€ æˆå†²çª</span><a href="#ä¸¤æ¬¡-ee-å£°æ˜ä¸æ»¡è¶³å¯èƒ½å†²çªçš„æ¡ä»¶ä¸é€ æˆå†²çª" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>6.4.1 [basic.scope.scope]:</p><blockquote><p><strong>Two declarations <em>potentially conflict</em> if they correspond and cause their shared name to denote different entities (6.6)</strong>. The program is ill-formed if, in any scope, a name is bound to two declarations that <em>potentially conflict</em> and one precedes the other (6.5).</p></blockquote><p>å½“ä¸¤ä¸ªå£°æ˜ã€Œå¯¹åº”ã€ï¼ˆæ»¡è¶³ï¼‰å¹¶ä½¿å¾—ä»–ä»¬å…±æœ‰çš„åå­—<strong>æŒ‡å‘ä¸¤ä¸ªä¸åŒå®ä½“æ—¶</strong>ï¼Œä¸¤ä¸ªå£°æ˜å³ã€Œå¯èƒ½å†²çªã€ã€‚</p><p>è€Œå‰é¢ä¸€æ®µå·²ç»è¯´æ˜äº†ï¼Œä¸¤æ¬¡ <code class="language-plaintext highlighter-rouge">ee</code> å£°æ˜ï¼ŒæŒ‡å‘çš„æ˜¯<strong>åŒä¸€å®ä½“</strong>ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™é‡Œã€Œå¯èƒ½å†²çªã€çš„è§„åˆ™å¹¶ä¸é€‚ç”¨ï¼Œä¸¤æ¬¡å£°æ˜ä¸å†²çªã€‚</p><h2 id="ç»“è®ºæšä¸¾é‡é‡å¤å®šä¹‰ä¸è¿å-c-æ ‡å‡†"><span class="mr-2">ç»“è®ºï¼šæšä¸¾é‡é‡å¤å®šä¹‰ä¸è¿å C++ æ ‡å‡†ï¼</span><a href="#ç»“è®ºæšä¸¾é‡é‡å¤å®šä¹‰ä¸è¿å-c-æ ‡å‡†" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>ç”±äº One-definition rule å¹¶ä¸é™åˆ¶æšä¸¾é‡çš„é‡å¤å®šä¹‰ï¼Œè€Œä¸¤æ¬¡æšä¸¾é‡å£°æ˜æŒ‡å‘çš„æ˜¯åŒä¸€ä¸ªå®ä½“ï¼Œä¸ä¼šé€ æˆå£°æ˜å†²çªï¼Œæ„å‘³ç€ä¸€å¼€å§‹çš„ç¤ºä¾‹ä»£ç ï¼š</p><div class="language-c++ highlighter-rouge"><div class="code-header"> <span data-label-text="C++"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="k">enum</span> <span class="p">{</span>
	<span class="n">ee</span><span class="p">,</span> <span class="n">ee</span>
<span class="p">};</span>
</pre></table></code></div></div><p>å…¶ä¸­é‡å¤çš„ <code class="language-plaintext highlighter-rouge">ee</code>ï¼Œæ— è®ºæ˜¯ä»å®ä½“å®šä¹‰çš„è§’åº¦ï¼Œè¿˜æ˜¯ä»å®ä½“å£°æ˜çš„è§’åº¦ï¼Œéƒ½<strong>ä¸è¿å C++ æ ‡å‡†ä¸­çš„è§„åˆ™</strong>ï¼Œä¹Ÿå°±æ˜¯è¯´å½“å‰ C++ æ ‡å‡†æ²¡æœ‰åƒ C æ ‡å‡†ä¸€æ ·æˆåŠŸé˜»æ­¢è¯¥æœ‰æ­§ä¹‰çš„ç¨‹åºé€šè¿‡ç¼–è¯‘ã€‚</p><h1 id="æ€»ç»“">æ€»ç»“</h1><p>å½“ç„¶ï¼Œå¯¹åŒä¸€ä¸ªåå­—è¿›è¡Œå¤šæ¬¡æšä¸¾é‡å®šä¹‰è‚¯å®šåœ¨é€»è¾‘ä¸Šæ˜¯é”™è¯¯çš„ï¼Œæ¯ä¸ªæšä¸¾é‡éƒ½å¿…é¡»å¯¹åº”ã€Œä¸€ä¸ªã€æ•´å‹å¸¸é‡ï¼Œæ¯ä¸€ä¸ªæšä¸¾é‡å®šä¹‰åˆä¼šä½¿å¾—æšä¸¾é‡å¯¹åº”çš„å¸¸é‡ç›¸æ¯”ä¸Šä¸€ä¸ªæšä¸¾é‡å®šä¹‰å¢1ï¼Œå…è®¸åŒä¸ªåå­—å®šä¹‰ä¸¤æ¬¡æšä¸¾é‡çš„è¯ï¼Œè¿™ä¸¤ä¸ªè§„åˆ™å°±äº§ç”ŸçŸ›ç›¾äº†ã€‚ï¼ˆä¾‹å¦‚ä¸Šé¢çš„ä¾‹å­é‡Œï¼Œee åŒæ—¶å¯¹åº” 0 å’Œ 1ï¼‰</p><p>åœ¨è¿™é‡Œï¼Œåˆç†çš„è§£å†³æ–¹æ³•åº”è¯¥æ˜¯å°†æšä¸¾å€¼ (enumeratorã€enumeration constant) åŠ å…¥åˆ° One-definition rule ä¸­ï¼Œé˜»æ­¢æšä¸¾å€¼çš„é‡å¤å®šä¹‰ã€‚</p><p>æˆ‘ä¹Ÿå°†ç›¸å…³çš„ä¿¡æ¯æäº¤ç»™äº† C++ æ ‡å‡†å§”å‘˜ä¼šç›¸å…³äººå‘˜ï¼Œå¹¶ç»è¿‡å‡ è½®é‚®ä»¶æ¥å›è§£é‡Šï¼Œè¯¥é—®é¢˜å·²ç»è¢«æ¥å—å¹¶æˆä¸º <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_active.html#2530">C++ æ ¸å¿ƒè¯­è¨€è®®é¢˜ #2530</a>ã€‚åº”è¯¥ä¼šåœ¨ä¸‹ä¸€æ¬¡å§”å‘˜ä¼šä¼šè®®ä¸­è®¨è®ºå¹¶å¯èƒ½åœ¨æœªæ¥è‰æ¡ˆä¸­ä¿®å¤ã€‚</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>That's a good point that I had overlooked; it seemed clear that 
two enumerators (that, in general, have different values) cannot 
declare the same entity, which in the case of an enumerator, is 
only a value. However, this wording contradicts that reasoning, 
so you've convinced me. This will be issue 2530 in revision 108 
of the core language issues list.
                                      -- William M. (Mike) Miller
</pre></table></code></div></div><p>æœ€å¥‡å¦™çš„æ˜¯ï¼Œè¿™ä¸ªç–å¿½è™½ç„¶çœ‹èµ·æ¥å¾ˆå¾®ä¸è¶³é“ï¼Œä½†å®ƒè‡³å°‘ä» <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2005/n1905.pdf">C++03</a> ä¹‹å‰å°±å­˜åœ¨äº†ï¼ˆC++03 æ ‡å‡†æ–‡æ¡£æœ‰ç‰ˆæƒé—®é¢˜ï¼Œè¿™é‡Œé“¾æ¥æ˜¯2005å¹´çš„å·¥ä½œç¨¿ï¼‰ï¼Œä¸€ç›´å­˜åœ¨äº†20æ¥å¹´ï¼ŒæœŸé—´çš„ç¼–è¯‘å™¨ä½œè€…ä¹Ÿéƒ½é»˜è®¤æŒ‰ç…§ C çš„è§„åˆ™å»å¤„ç†äº†ï¼Œä¹Ÿæ²¡æœ‰äººæäº¤è¿‡ç›¸å…³ defectã€‚ç”šè‡³æœ‰ç†ç”±æ€€ç–‘æ˜¯ C++ æ ‡å‡†é‡Œå­˜åœ¨æ—¶é—´æœ€ä¹…çš„ bug ä¹‹ä¸€ï¼Œæœç„¶æœ€ç®€å•çš„é—®é¢˜è—åœ¨çœ¼çš®åº•ä¸‹åè€Œä¸å®¹æ˜“è¢«å‘ç° ğŸ˜ƒ ã€‚</p><blockquote><p>æˆ‘çš„åšå®¢å³å°†åŒæ­¥è‡³è…¾è®¯äº‘å¼€å‘è€…ç¤¾åŒºï¼Œé‚€è¯·å¤§å®¶ä¸€åŒå…¥é©»ï¼šhttps://cloud.tencent.com/developer/support-plan?invite_code=h98n0pl8nhui</p></blockquote></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/language/'>Language</a>, <a href='/categories/c/'>C++</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/c-standard/" class="post-tag no-text-decoration" >c++ standard</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=%E8%AE%B0%E4%B8%80%E6%AC%A1+C%2B%2B+%E6%A0%B8%E5%BF%83%E8%AF%AD%E8%A8%80%E6%A0%87%E5%87%86%E4%B8%AD%E4%B8%80%E4%B8%AA+issue+%E7%9A%84%E5%8F%91%E7%8E%B0%E5%92%8C%E6%8F%90%E4%BA%A4%E7%BB%8F%E5%8E%86+-+Miigon%27s+blog&url=https%3A%2F%2Fblog.miigon.net%2Fposts%2Fcpp-core-language-issue-for-enum-const-redefinition%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=%E8%AE%B0%E4%B8%80%E6%AC%A1+C%2B%2B+%E6%A0%B8%E5%BF%83%E8%AF%AD%E8%A8%80%E6%A0%87%E5%87%86%E4%B8%AD%E4%B8%80%E4%B8%AA+issue+%E7%9A%84%E5%8F%91%E7%8E%B0%E5%92%8C%E6%8F%90%E4%BA%A4%E7%BB%8F%E5%8E%86+-+Miigon%27s+blog&u=https%3A%2F%2Fblog.miigon.net%2Fposts%2Fcpp-core-language-issue-for-enum-const-redefinition%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fblog.miigon.net%2Fposts%2Fcpp-core-language-issue-for-enum-const-redefinition%2F&text=%E8%AE%B0%E4%B8%80%E6%AC%A1+C%2B%2B+%E6%A0%B8%E5%BF%83%E8%AF%AD%E8%A8%80%E6%A0%87%E5%87%86%E4%B8%AD%E4%B8%80%E4%B8%AA+issue+%E7%9A%84%E5%8F%91%E7%8E%B0%E5%92%8C%E6%8F%90%E4%BA%A4%E7%BB%8F%E5%8E%86+-+Miigon%27s+blog" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/storing-hash-objects-on-filesystem/">[éšç¬”]æ–‡ä»¶ç³»ç»Ÿä¸Šå­˜å‚¨å“ˆå¸Œå¯¹è±¡ï¼šå“ˆå¸Œç®—æ³•ä»¥åŠç›®å½•ç»“æ„å¯¹æ€§èƒ½çš„å½±å“</a><li><a href="/posts/origin-of-git-feat-bitkeeper/">gitçš„å‰ä¸–ï¼Œå’ŒBitKeeper</a><li><a href="/posts/golang-loop-var-reference-problems-and-semantic-fix/">éšç¬”ï¼šGolang å¾ªç¯å˜é‡å¼•ç”¨é—®é¢˜ä»¥åŠå®˜æ–¹è¯­ä¹‰ä¿®å¤</a><li><a href="/posts/s081-lab6-copy-on-write-fork/">[mit6.s081] ç¬”è®° Lab6: Copy-on-write fork | fork æ‡’æ‹·è´</a><li><a href="/posts/mysql-prepare-slower-query-bug-analyze/">MySQL Prepareåè¯­å¥æŸ¥è¯¢æ€§èƒ½é™ä½ å†…æ ¸æºç bugæ’æŸ¥åˆ†æ</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/operating-system/">operating system</a> <a class="post-tag" href="/tags/chinese/">Chinese</a> <a class="post-tag" href="/tags/system-design/">system design</a> <a class="post-tag" href="/tags/c/">C++</a> <a class="post-tag" href="/tags/course-recommendation/">course recommendation</a> <a class="post-tag" href="/tags/grpc/">gRPC</a> <a class="post-tag" href="/tags/translated/">translated</a> <a class="post-tag" href="/tags/announcement/">announcement</a> <a class="post-tag" href="/tags/c-standard/">c++ standard</a> <a class="post-tag" href="/tags/computer-system/">computer system</a></div></div><div id="access-links" class="post"><div class="panel-heading">Links</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="http://0xffff.one">0xffff.one æ¬ç –æŠ€æœ¯ç¤¾åŒº</a><li><a href="https://blog.izgq.net">ZGQ's Blog</a></ul></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/golang-loop-var-reference-problems-and-semantic-fix/"><div class="card-body"> <em class="small" data-ts="1678871100" data-df="ll" > Mar 15, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>éšç¬”ï¼šGolang å¾ªç¯å˜é‡å¼•ç”¨é—®é¢˜ä»¥åŠå®˜æ–¹è¯­ä¹‰ä¿®å¤</h3><div class="text-muted small"><p> è¿™ç¯‡æ–‡ç« è°ˆä¸€ä¸ªå·²ç»åœ¨ Golang ä¸­å­˜åœ¨å¤šå¹´çš„ï¼Œå‡ ä¹æ¯ä¸€ä¸ªæ–°æ‰‹éƒ½è¦è¢«å‘ä¸€éçš„è®¾è®¡ï¼šå¼•ç”¨æ•è·äº†å¾ªç¯å˜é‡ï¼Œä¸”é€ƒé€¸å‡ºå¾ªç¯è¿­ä»£èŒƒå›´è€Œé€ æˆçš„é€»è¾‘é”™è¯¯ã€‚ ä»¥åŠé‡ç‚¹æ˜¯è®¨è®ºäº†ç›®å‰å¯¹è¿™ä¸ªå¸¸è§é—®é¢˜çš„è§£å†³åŠæ³•çš„æ¢ç´¢ï¼ˆé™æ€åˆ†æå­˜åœ¨çš„ä¸è¶³ï¼Œä»¥åŠ2022å¹´10æœˆ Golang å®˜æ–¹æå‡ºçš„ç›´æ¥æ›´æ”¹ for å¾ªç¯å˜é‡è¯­ä¹‰ï¼Œä»è¯­è¨€è®¾è®¡ä¸Šæ ¹æœ¬åœ°æ¶ˆé™¤è¿™ä¸ªé—®é¢˜çš„ proposalï¼‰ background è¿™ä¸ªé—®é¢˜æ˜¯ä¸€ä¸ª Go...</p></div></div></a></div><div class="card"> <a href="/posts/storing-hash-objects-on-filesystem/"><div class="card-body"> <em class="small" data-ts="1672391760" data-df="ll" > Dec 30, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[éšç¬”]æ–‡ä»¶ç³»ç»Ÿä¸Šå­˜å‚¨å“ˆå¸Œå¯¹è±¡ï¼šå“ˆå¸Œç®—æ³•ä»¥åŠç›®å½•ç»“æ„å¯¹æ€§èƒ½çš„å½±å“</h3><div class="text-muted small"><p> ä»æ–‡ä»¶ç³»ç»Ÿçš„å®ç°åŸç†è§’åº¦è®¨è®º /77/e1/77e1cccccc... æ¨¡å¼çš„ hash object å‘½åçš„ä¼˜ç‚¹ä»¥åŠå¿…è¦/ä¸å¿…è¦æ€§ï¼Œä»¥åŠç®—æ³•é€‰æ‹©ã€‚ åŸè´´ è¿™æ˜¯æˆ‘åœ¨ 0xffff è®ºå›çš„å›å¸–çš„å¤‡æ¡£ï¼šhttps://0xffff.one/d/1395-wen-jian-xi-tong-zuo-wei-huan-cun ä¸€ä¸ªå¸¸è§çš„ä¸šåŠ¡åœºæ™¯ï¼Œéœ€è¦å®ç°ä¸€ä¸ª Key-Value Cach...</p></div></div></a></div><div class="card"> <a href="/posts/does-linux-has-zombie-thread/"><div class="card-body"> <em class="small" data-ts="1669196820" data-df="ll" > Nov 23, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Linux æ˜¯å¦æœ‰ zombie threadï¼Ÿä»glibcå’Œå†…æ ¸æºç æ¢ç©¶</h3><div class="text-muted small"><p> ç³»ç»Ÿç¼–ç¨‹è¯¾ä¸Šé‡åˆ°çš„ä¸€ä¸ªé—®é¢˜ï¼šLinuxä¸‹ï¼Œå¦‚æœä¸€ä¸ª pthread_create åˆ›å»ºçš„çº¿ç¨‹æ²¡æœ‰è¢« pthread_join å›æ”¶ï¼Œæ˜¯å¦ä¼šå’Œåƒµå°¸è¿›ç¨‹ä¸€æ ·ï¼Œäº§ç”Ÿâ€œåƒµå°¸çº¿ç¨‹â€ï¼Œå¹¶ä¸€ç›´å ç”¨ä¸€ä¸ª pid/tidï¼Ÿ çŒœæƒ³ åƒµå°¸è¿›ç¨‹ å¯¹äºè¿›ç¨‹ä¸å­è¿›ç¨‹æ¥è¯´ï¼Œå¦‚æœå­è¿›ç¨‹é€€å‡ºäº†ï¼Œä½†æ˜¯çˆ¶è¿›ç¨‹ä¸å¯¹å­è¿›ç¨‹è¿›è¡Œ reap ï¼ˆå³ä½¿ç”¨ wait/waitpid å¯¹å­è¿›ç¨‹è¿›è¡Œå›æ”¶ï¼‰ï¼Œåˆ™å­è¿›ç¨‹çš„ PCBï¼ˆå†…æ ¸ä¸­çš„ ta...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/postgresql-source-compilation-guide/" class="btn btn-outline-primary" prompt="Older"><p>[SZU] æ•°æ®åº“å†…æ ¸è¯¾ç¨‹ PostgreSQL 12.5 æºç å®‰è£…é¿å‘ guide</p></a> <a href="/posts/origin-of-git-feat-bitkeeper/" class="btn btn-outline-primary" prompt="Newer"><p>gitçš„å‰ä¸–ï¼Œå’ŒBitKeeper</p></a></div><script type="text/javascript"> $(function () { const origin = "https://giscus.app"; const iframe = "iframe.giscus-frame"; const lightTheme = "light"; const darkTheme = "dark_dimmed"; let initTheme = lightTheme; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } let giscusAttributes = { "src": "https://giscus.app/client.js", "data-repo": "Miigon/blog", "data-repo-id": "MDEwOlJlcG9zaXRvcnkzMjI1MjkwNzA=", "data-category": "BlogComments", "data-category-id": "DIC_kwDOEzlnLs4CQ6Y4", "data-mapping": "pathname", "data-reactions-enabled": "1", "data-emit-metadata": "0", "data-theme": initTheme, "data-input-position": "top", "data-lang": "en", "crossorigin": "anonymous", "async": "" }; let giscusScript = document.createElement("script"); Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value)); document.getElementById("tail-wrapper").prepend(giscusScript); addEventListener("message", (event) => { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; const theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); const message = { setConfig: { theme: theme } }; const giscus = document.querySelector(iframe).contentWindow; giscus.postMessage({ giscus: message }, origin); } }); }); </script></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> Â© 2023 <a href="https://github.com/Miigon">Miigon</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Customized Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/operating-system/">operating system</a> <a class="post-tag" href="/tags/chinese/">Chinese</a> <a class="post-tag" href="/tags/system-design/">system design</a> <a class="post-tag" href="/tags/c/">C++</a> <a class="post-tag" href="/tags/course-recommendation/">course recommendation</a> <a class="post-tag" href="/tags/grpc/">gRPC</a> <a class="post-tag" href="/tags/translated/">translated</a> <a class="post-tag" href="/tags/announcement/">announcement</a> <a class="post-tag" href="/tags/c-standard/">c++ standard</a> <a class="post-tag" href="/tags/computer-system/">computer system</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
